<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏•‡πà‡∏≤‡∏ó‡πâ‡∏≤‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏µ üëª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    body {
      margin: 0;
      font-family: "Prompt", sans-serif;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #fff;
    }

    .app {
      width: 100%;
      max-width: 380px;
      background: #ffffff;
      color: #333;
      border-radius: 22px;
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(0,0,0,.3);
    }

    .header {
      background: linear-gradient(135deg, #512da8, #673ab7);
      padding: 20px;
      text-align: center;
      color: #fff;
    }

    .header h1 {
      margin: 0;
      font-size: 22px;
    }

    .score {
      margin-top: 8px;
      font-size: 16px;
      opacity: .9;
    }

    .content {
      padding: 20px;
      text-align: center;
    }

    .status {
      font-size: 22px;
      margin-bottom: 10px;
    }

    .ghost {
      color: #e53935;
    }

    .safe {
      color: #43a047;
    }

    .desc {
      font-size: 14px;
      color: #666;
      margin-bottom: 20px;
    }

    button {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      border-radius: 14px;
      border: none;
      cursor: pointer;
      font-family: inherit;
      transition: .2s;
    }

    .btn-main {
      background: linear-gradient(135deg, #ff5252, #ff1744);
      color: #fff;
      margin-bottom: 12px;
    }

    .btn-main:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    .btn-reward {
      background: linear-gradient(135deg, #00c853, #00e676);
      color: #fff;
    }

    .reward-panel {
      display: none;
      padding: 16px;
      border-top: 1px solid #eee;
    }

    .reward {
      background: #f5f7fa;
      border-radius: 12px;
      padding: 12px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .reward span {
      font-size: 14px;
    }

    .reward button {
      width: auto;
      padding: 8px 14px;
      font-size: 14px;
      background: #1976d2;
      color: white;
      border-radius: 10px;
    }

    .footer {
      text-align: center;
      font-size: 12px;
      color: #999;
      padding: 10px;
    }
  </style>
</head>
<body>

<div class="app">
  <div class="header">
    <h1>üéØ ‡∏•‡πà‡∏≤‡∏ó‡πâ‡∏≤‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏µ</h1>
    <div class="score">
      ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏™‡∏∞‡∏™‡∏°: <strong id="score">0</strong> ‡πÅ‡∏ï‡πâ‡∏°
    </div>
  </div>

  <div class="content">
    <div id="status" class="status ghost">
      üëª ‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏µ
    </div>

    <div class="desc">
      ‡∏û‡∏ö‡πÇ‡∏ï‡πä‡∏∞‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡∏≠‡∏á‡∏ß‡∏≤‡∏á‡∏ó‡∏¥‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô<br>
      ‡∏Å‡∏î‡∏õ‡∏•‡∏î‡πÇ‡∏ï‡πä‡∏∞‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÇ‡∏ï‡πä‡∏∞‡∏ß‡πà‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ
    </div>

    <button id="scanBtn" class="btn-main" onclick="scanTable()">
      ‡∏õ‡∏•‡∏î‡πÇ‡∏ï‡πä‡∏∞ (+10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)
    </button>

    <button class="btn-reward" onclick="toggleRewards()">
      üéÅ ‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•
    </button>
  </div>

  <div class="reward-panel" id="rewardPanel">
    <div class="reward">
      <span>‚òï ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏Å‡∏≤‡πÅ‡∏ü 10 ‡∏ö‡∏≤‡∏ó<br>‡πÉ‡∏ä‡πâ 20 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
      <button onclick="redeem(20)">‡πÅ‡∏•‡∏Å</button>
    </div>
    <div class="reward">
      <span>üç™ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏Ç‡∏ô‡∏° 20 ‡∏ö‡∏≤‡∏ó<br>‡πÉ‡∏ä‡πâ 30 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
      <button onclick="redeem(30)">‡πÅ‡∏•‡∏Å</button>
    </div>
    <div class="reward">
      <span>ü•§ ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°‡∏ü‡∏£‡∏µ<br>‡πÉ‡∏ä‡πâ 50 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</span>
      <button onclick="redeem(50)">‡πÅ‡∏•‡∏Å</button>
    </div>
  </div>

  <div class="footer">
    Gamification for Library Space
  </div>
</div>

<script>
  // ===== ‡∏î‡∏∂‡∏á tableId ‡∏à‡∏≤‡∏Å URL =====
  const urlParams = new URLSearchParams(window.location.search);
  const tableId = urlParams.get("tableId") || "unknown";

  // ===== STATE =====
let statusKey = `status_${tableId}`; // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏¢‡∏±‡∏á‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏° tableId
let scoreKey = "totalScore"; // ‡πÉ‡∏ä‡πâ key ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

let status = localStorage.getItem(statusKey) || "ghost";
let score = Number(localStorage.getItem(scoreKey)) || 0;

const statusEl = document.getElementById("status");
const scoreEl = document.getElementById("score");
const scanBtn = document.getElementById("scanBtn");

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
function updateUI() {
  if(status === "ghost") {
    statusEl.textContent = "üëª ‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏µ";
    statusEl.className = "status ghost";
    scanBtn.textContent = "‡∏õ‡∏•‡∏î‡πÇ‡∏ï‡πä‡∏∞ (+10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)";
  } else {
    statusEl.textContent = "‚úÖ ‡πÇ‡∏ï‡πä‡∏∞‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢";
    statusEl.className = "status safe";
    scanBtn.textContent = "‡∏ó‡∏≥‡πÇ‡∏ï‡πä‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏µ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á";
  }
  scoreEl.textContent = score;
}

updateUI();

function scanTable() {
  if(status === "ghost") {
    // ghost ‚Üí safe
    status = "safe";
    score += 10;
    alert(`üéâ ‡∏õ‡∏•‡∏î‡πÇ‡∏ï‡πä‡∏∞ ${tableId} ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à +10 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô`);
  } else {
    // safe ‚Üí ghost
    status = "ghost";
    alert(`üëª ‡πÇ‡∏ï‡πä‡∏∞ ${tableId} ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÇ‡∏ï‡πä‡∏∞‡∏ú‡∏µ`);
  }

  // ‡πÄ‡∏Å‡πá‡∏ö localStorage
  localStorage.setItem(statusKey, status); // ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏¢‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡πÅ‡∏¢‡∏Å table
  localStorage.setItem(scoreKey, score);   // ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÉ‡∏ä‡πâ‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

  updateUI();
}

function toggleRewards() {
  const panel = document.getElementById("rewardPanel");
  panel.style.display = panel.style.display === "block" ? "none" : "block";
}

function redeem(cost) {
  if (score < cost) {
    alert("‚ùå ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠");
    return;
  }

  score -= cost;
  localStorage.setItem(scoreKey, score);
  updateUI();

  alert("üéÅ ‡πÅ‡∏•‡∏Å‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤");
}

</script>



</body>
</html>
